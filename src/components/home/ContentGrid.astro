---
import BlogCard from '@/components/blog/card/index.astro';
import { routes } from '@/configs/routes';
import type { BlogPostWithAuthors, NoteWithAuthors } from '@/lib/collections';
import { formatCompactDate, formatISO } from '@/lib/format';

interface Props {
  posts?: BlogPostWithAuthors[];
  notes?: NoteWithAuthors[];
  className?: string;
}

const { posts = [], notes = [], className = '' } = Astro.props;
---

<!-- Bento Grid -->
<div class={`grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4 ${className}`}>
  {/* Main blog post - takes 2 columns */}
  {
    posts.length > 0 && (
      <div class="relative col-span-full md:col-span-2 lg:col-span-2">
        <BlogCard post={posts[0]!} className="h-full" layout="horizontal" size="lg" />
        <div class="absolute right-0 top-0 z-20 rounded-bl-lg rounded-tr-lg bg-primary/90 px-3 py-1 text-xs font-medium uppercase tracking-wider text-primary-foreground shadow-sm">
          blog
        </div>
      </div>
    )
  }

  {/* First note - takes 1 column */}
  {
    notes.length > 0 && (
      <div class="relative col-span-full md:col-span-1 lg:col-span-1">
        <a
          href={routes.note({ slug: notes[0]!.slug })}
          class="group flex h-full min-h-[180px] flex-col justify-between rounded-lg border border-border/40 bg-card p-4 shadow-sm transition duration-200 hover:shadow-md dark:border-white/[0.2]"
        >
          <div class="flex items-center justify-between">
            <time
              datetime={formatISO(notes[0]!.data.published_date)}
              class="text-xs text-muted-foreground"
            >
              {formatCompactDate(notes[0]!.data.published_date)}
            </time>
          </div>
          <div class="transition duration-200 group-hover:translate-x-2">
            <h3 class="mb-2 line-clamp-2 font-medium tracking-tight text-foreground">
              {notes[0]!.data.title}
            </h3>
            {notes[0]!.data.description && (
              <p class="line-clamp-3 text-sm text-muted-foreground">{notes[0]!.data.description}</p>
            )}
          </div>
        </a>
        <div class="absolute right-0 top-0 z-20 rounded-bl-lg rounded-tr-lg bg-secondary/90 px-3 py-1 text-xs font-medium uppercase tracking-wider text-secondary-foreground shadow-sm">
          note
        </div>
      </div>
    )
  }

  {/* Second blog post - takes 1 column */}
  {
    posts.length > 1 && (
      <div class="relative col-span-full md:col-span-1 lg:col-span-1">
        <BlogCard post={posts[1]!} className="h-full" layout="default" size="sm" />
        <div class="absolute right-0 top-0 z-20 rounded-bl-lg rounded-tr-lg bg-primary/90 px-3 py-1 text-xs font-medium uppercase tracking-wider text-primary-foreground shadow-sm">
          blog
        </div>
      </div>
    )
  }

  {/* Third blog post - takes 1 column */}
  {
    posts.length > 2 && (
      <div class="relative col-span-full md:col-span-1 lg:col-span-1">
        <BlogCard post={posts[2]!} className="h-full" layout="default" size="sm" />
        <div class="absolute right-0 top-0 z-20 rounded-bl-lg rounded-tr-lg bg-primary/90 px-3 py-1 text-xs font-medium uppercase tracking-wider text-primary-foreground shadow-sm">
          blog
        </div>
      </div>
    )
  }

  {/* Second note - takes 1 column */}
  {
    notes.length > 1 && (
      <div class="relative col-span-full md:col-span-1 lg:col-span-1">
        <a
          href={routes.note({ slug: notes[1]!.slug })}
          class="group flex h-full min-h-[180px] flex-col justify-between rounded-lg border border-border/40 bg-card p-4 shadow-sm transition duration-200 hover:shadow-md dark:border-white/[0.2]"
        >
          <div class="flex items-center justify-between">
            <time
              datetime={formatISO(notes[1]!.data.published_date)}
              class="text-xs text-muted-foreground"
            >
              {formatCompactDate(notes[1]!.data.published_date)}
            </time>
          </div>
          <div class="transition duration-200 group-hover:translate-x-2">
            <h3 class="mb-2 line-clamp-2 font-medium tracking-tight text-foreground">
              {notes[1]!.data.title}
            </h3>
            {notes[1]!.data.description && (
              <p class="line-clamp-3 text-sm text-muted-foreground">{notes[1]!.data.description}</p>
            )}
          </div>
        </a>
        <div class="absolute right-0 top-0 z-20 rounded-bl-lg rounded-tr-lg bg-secondary/90 px-3 py-1 text-xs font-medium uppercase tracking-wider text-secondary-foreground shadow-sm">
          note
        </div>
      </div>
    )
  }

  {/* Fourth blog post - takes 2 columns */}
  {
    posts.length > 3 && (
      <div class="relative col-span-full md:col-span-2 lg:col-span-2">
        <BlogCard post={posts[3]!} className="h-full" layout="horizontal" size="lg" />
        <div class="absolute right-0 top-0 z-20 rounded-bl-lg rounded-tr-lg bg-primary/90 px-3 py-1 text-xs font-medium uppercase tracking-wider text-primary-foreground shadow-sm">
          blog
        </div>
      </div>
    )
  }
</div>
